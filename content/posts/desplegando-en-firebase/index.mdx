---
title: Desplegando en Firebase
date: 2022-05-20
description: C√≥mo se realiza un despliegue en Firebase
tags:
  - firebase
  - gcp
  - cd
  - projects
banner: ./thomas-drouault-h7PJC8pvmHI-unsplash.jpg
---

Es cierto que para un proyecto de este tipo tampoco ser√≠a muy tedioso ejecutar un simple `gatsby build` y tras esperar unos minutos hacer un `firebase deploy`.

Pero a medida que crezca el n√∫mero de art√≠culos posiblemente se tome m√°s tiempo en completar el `build`, por esto nos viene muy bien seguir una estrategia de CD (Continuous Deployment) para poder automatizar este proceso.

En este caso es bastante simple, ya que por la arquitectura actual del proyecto no era necesario implementar CI (Continuous Integration). Por lo que el ciclo de CD quedar√≠a de la siguiente forma.

![Ciclo CD](./cd-cicle.png)

### ¬øC√≥mo configuramos esto?

Si bien en este art√≠culo no se explicar√° en detalle el proceso de configuraci√≥n e integraci√≥n de este sistema, s√≠ quiero se√±alar a simple vista qu√© elementos intervienen en este proceso y mostrar lo sencillo que fu√© para este proyecto.
En un futuro elaborar√© un tutorial bajo un mini-proyecto para explicar la configuraci√≥n paso a paso.

Lo primero es tener una cuenta de **Google** para poder realizar `login` en la plataforma de Firebase.

![Consola de Firebase](./firebase-console.png)

Despu√©s de esto, si pulsamos en `Agregar proyecto`, seguimos el asistente y podremos crear un nuevo proyecto o elegir uno existente que tengamos en **Google Cloud**.

Una vez configurado el proyecto podemos vincularlo con la librer√≠a `firebase-tools` que agregaremos a nuestro proyecto local.

``` noLineNumbers
npm install -g firebase-tools
```

Luego deberemos de autenticarnos en Google Cloud a trav√©s del CLI de Firebase.

``` noLineNumbers
firebase login
```

Tras realizar la autenticaci√≥n podremos inicializar Firebase.

``` noLineNumbers
firebase init
```
Nos aparecer√° un asistente de configuraci√≥n bastante intuitivo.

![Salida de comando firebase init](./firebase-init.png)

Para este caso escogimos la opci√≥n de **"Hosting: ... GitHub Action deploys"**.

Esto nos establece toda la configuraci√≥n necesaria para su despliegue en el hosting de Firebase y adem√°s nos configura
un **workflow** para **GitHub** el cual nos despliega de forma autom√°tica el proyecto cuando hagamos un `push` con la rama que tengamos configurada.

Al terminar todos los pasos anteriores tendremos en nuestro proyecto los siguientes nuevos recursos referentes a Firebase.

![√Årbol de archivos Firebase](./tree-firebase.png)

Importante a√±adir a nuestro `.gitignore` la carpeta `.firebase`.

Si nos fijamos en la carpeta `.github/workflows`, contiene una serie de ficheros que ser√°n los que interprete GitHub para ejecutar GitHub Actions.

He tenido que hacer una serie de ajustes al fichero [firebase-hosting-merge.yml](https://github.com/jsm94/stunnin.dev/blob/master/.github/workflows/firebase-hosting-merge.yml) que te crea por defecto para la acci√≥n `push`, como por ejemplo a√±adir un paso para la instalaci√≥n de las dependencias.

Tambi√©n es importante configurar los ajustes de cach√© en el fichero [firebase.json](https://github.com/jsm94/stunnin.dev/blob/master/firebase.json) tal y como se aconseja en la [documentaci√≥n oficial de Gatsby](https://www.gatsbyjs.com/docs/how-to/previews-deploys-hosting/deploying-to-firebase/).

Con todo esto configurado s√≥lo tengo hacer `push` y se estar√°n desplegando autom√°ticamente los cambios a producci√≥n.

![Pasos de despliegue a producci√≥n a trav√©s de GitHub Actions](./github-actions.png)

üöÄ

Foto de portada de [Thomas Drouault](https://unsplash.com/es/@thomasdrouaultphotography) en [Unsplash](https://unsplash.com/)
